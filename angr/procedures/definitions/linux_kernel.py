from . import SimSyscallLibrary
from .. import SIM_PROCEDURES as P

lib = SimSyscallLibrary()
lib.set_library_names('linux')
lib.add_all_from_dict(P['linux_kernel'])
lib.add_alias('exit', 'exit_group')

lib.add_number_mapping_from_dict('AMD64', {
    0:   'read',
    1:   'write',
    2:   'open',
    3:   'close',
    4:   'stat',
    5:   'fstat',
    6:   'stat',
    8:   'lseek',
    9:   'mmap',
    10:  'mprotect',
    11:  'munmap',
    12:  'brk',
    13:  'sigaction',
    14:  'sigprocmask',
    39:  'getpid',
    60:  'exit',
    63:  'uname',
    87:  'unlink',
    97:  'getrlimit',
    158: 'arch_prctl',
    186: 'gettid',
    201: 'time',
    202: 'futex',
    218: 'set_tid_address',
    231: 'exit_group',
    234: 'tgkill',
})

lib.add_number_mapping_from_dict('X86', {
    1:   'exit',
    3:   'read',
    4:   'write',
    5:   'open',
    6:   'close',
    13:  'time',
    45:  'brk',
    122: 'uname',
    252: 'exit_group',
})

lib.add_number_mapping_from_dict('PPC32', {
    1:  'exit',
    3:  'read',
    4:  'write',
    5:  'open',
    6:  'close',
    45: 'brk',
})

lib.add_number_mapping_from_dict('MIPS32', {
    4001: 'exit',
    4003: 'read',
    4004: 'write',
    4005: 'open',
    4006: 'close',
    4045: 'brk',
})

lib.add_number_mapping_from_dict('MIPS64', {
    5000: 'read',
    5001: 'write',
    5002: 'open',
    5003: 'close',
    5012: 'brk',
    5058: 'exit',
})

# Ref: https://github.com/raspberrypi/linux/blob/rpi-4.9.y/arch/arm/include/uapi/asm/unistd.h
lib.add_number_mapping_from_dict('ARMEL', {
    0:      'restart_syscall',
    1:      'exit',
    2:      'fork',
    3:      'read',
    4:      'write',
    5:      'open',
    6:      'close',
    8:      'creat',
    9:      'link',
    10:     'unlink',
    11:     'execve',
    12:     'chdir',
    13:     'time',
    14:     'mknod',
    15:     'chmod',
    16:     'lchown',
    19:     'lseek',
    20:     'getpid',
    21:     'mount',
    22:     'umount',
    23:     'setuid',
    24:     'getuid',
    25:     'stime',
    26:     'ptrace',
    27:     'alarm',
    29:     'pause',
    30:     'utime',
    33:     'access',
    34:     'nice',
    36:     'sync',
    37:     'kill',
    38:     'rename',
    39:     'mkdir',
    40:     'rmdir',
    41:     'dup',
    42:     'pipe',
    43:     'times',
    45:     'brk',
    46:     'setgid',
    47:     'getgid',
    49:     'geteuid',
    50:     'getegid',
    51:     'acct',
    52:     'umount2',
    54:     'ioctl',
    55:     'fcntl',
    57:     'setpgid',
    60:     'umask',
    61:     'chroot',
    62:     'ustat',
    63:     'dup2',
    64:     'getppid',
    65:     'getpgrp',
    66:     'setsid',
    67:     'sigaction',
    70:     'setreuid',
    71:     'setregid',
    72:     'sigsuspend',
    73:     'sigpending',
    74:     'sethostname',
    75:     'setrlimit',
    76:     'getrlimit',
    77:     'getrusage',
    78:     'gettimeofday',
    79:     'settimeofday',
    80:     'getgroups',
    81:     'setgroups',
    82:     'select',
    83:     'symlink',
    85:     'readlink',
    86:     'uselib',
    87:     'swapon',
    88:     'reboot',
    89:     'readdir',
    90:     'mmap',
    91:     'munmap',
    92:     'truncate',
    93:     'ftruncate',
    94:     'fchmod',
    95:     'fchown',
    96:     'getpriority',
    97:     'setpriority',
    99:     'statfs',
    100:    'fstatfs',
    102:    'socketcall',
    103:    'syslog',
    104:    'setitimer',
    105:    'getitimer',
    106:    'stat',
    107:    'lstat',
    108:    'fstat',
    111:    'vhangup',
    113:    'syscall',
    114:    'wait4',
    115:    'swapoff',
    116:    'sysinfo',
    117:    'ipc',
    118:    'fsync',
    119:    'sigreturn',
    120:    'clone',
    121:    'setdomainname',
    122:    'uname',
    124:    'adjtimex',
    125:    'mprotect',
    126:    'sigprocmask',
    128:    'init_module',
    129:    'delete_module',
    131:    'quotactl',
    132:    'getpgid',
    133:    'fchdir',
    134:    'bdflush',
    135:    'sysfs',
    136:    'personality',
    138:    'setfsuid',
    139:    'setfsgid',
    140:    '_llseek',
    141:    'getdents',
    142:    '_newselect',
    143:    'flock',
    144:    'msync',
    145:    'readv',
    146:    'writev',
    147:    'getsid',
    148:    'fdatasync',
    149:    '_sysctl',
    150:    'mlock',
    151:    'munlock',
    152:    'mlockall',
    153:    'munlockall',
    154:    'sched_setparam',
    155:    'sched_getparam',
    156:    'sched_setscheduler',
    157:    'sched_getscheduler',
    158:    'sched_yield',
    159:    'sched_get_priority_max',
    160:    'sched_get_priority_min',
    161:    'sched_rr_get_interval',
    162:    'nanosleep',
    163:    'mremap',
    164:    'setresuid',
    165:    'getresuid',
    168:    'poll',
    169:    'nfsservctl',
    170:    'setresgid',
    171:    'getresgid',
    172:    'prctl',
    173:    'rt_sigreturn',
    174:    'rt_sigaction',
    175:    'rt_sigprocmask',
    176:    'rt_sigpending',
    177:    'rt_sigtimedwait',
    178:    'rt_sigqueueinfo',
    179:    'rt_sigsuspend',
    180:    'pread64',
    181:    'pwrite64',
    182:    'chown',
    183:    'getcwd',
    184:    'capget',
    185:    'capset',
    186:    'sigaltstack',
    187:    'sendfile',
    190:    'vfork',
    191:    'ugetrlimit',
    192:    'mmap2',
    193:    'truncate64',
    194:    'ftruncate64',
    195:    'stat64',
    196:    'lstat64',
    197:    'fstat64',
    198:    'lchown32',
    199:    'getuid32',
    200:    'getgid32',
    201:    'geteuid32',
    202:    'getegid32',
    203:    'setreuid32',
    204:    'setregid32',
    205:    'getgroups32',
    206:    'setgroups32',
    207:    'fchown32',
    208:    'setresuid32',
    209:    'getresuid32',
    210:    'setresgid32',
    211:    'getresgid32',
    212:    'chown32',
    213:    'setuid32',
    214:    'setgid32',
    215:    'setfsuid32',
    216:    'setfsgid32',
    217:    'getdents64',
    218:    'pivot_root',
    219:    'mincore',
    220:    'madvise',
    221:    'fcntl64',
    224:    'gettid',
    225:    'readahead',
    226:    'setxattr',
    227:    'lsetxattr',
    228:    'fsetxattr',
    229:    'getxattr',
    230:    'lgetxattr',
    231:    'fgetxattr',
    232:    'listxattr',
    233:    'llistxattr',
    234:    'flistxattr',
    235:    'removexattr',
    236:    'lremovexattr',
    237:    'fremovexattr',
    238:    'tkill',
    239:    'sendfile64',
    240:    'futex',
    241:    'sched_setaffinity',
    242:    'sched_getaffinity',
    243:    'io_setup',
    244:    'io_destroy',
    245:    'io_getevents',
    246:    'io_submit',
    247:    'io_cancel',
    248:    'exit_group',
    249:    'lookup_dcookie',
    250:    'epoll_create',
    251:    'epoll_ctl',
    252:    'epoll_wait',
    253:    'remap_file_pages',
    256:    'set_tid_address',
    257:    'timer_create',
    258:    'timer_settime',
    259:    'timer_gettime',
    260:    'timer_getoverrun',
    261:    'timer_delete',
    262:    'clock_settime',
    263:    'clock_gettime',
    264:    'clock_getres',
    265:    'clock_nanosleep',
    266:    'statfs64',
    267:    'fstatfs64',
    268:    'tgkill',
    269:    'utimes',
    270:    'arm_fadvise64_64',
    271:    'pciconfig_iobase',
    272:    'pciconfig_read',
    273:    'pciconfig_write',
    274:    'mq_open',
    275:    'mq_unlink',
    276:    'mq_timedsend',
    277:    'mq_timedreceive',
    278:    'mq_notify',
    279:    'mq_getsetattr',
    280:    'waitid',
    281:    'socket',
    282:    'bind',
    283:    'connect',
    284:    'listen',
    285:    'accept',
    286:    'getsockname',
    287:    'getpeername',
    288:    'socketpair',
    289:    'send',
    290:    'sendto',
    291:    'recv',
    292:    'recvfrom',
    293:    'shutdown',
    294:    'setsockopt',
    295:    'getsockopt',
    296:    'sendmsg',
    297:    'recvmsg',
    298:    'semop',
    299:    'semget',
    300:    'semctl',
    301:    'msgsnd',
    302:    'msgrcv',
    303:    'msgget',
    304:    'msgctl',
    305:    'shmat',
    306:    'shmdt',
    307:    'shmget',
    308:    'shmctl',
    309:    'add_key',
    310:    'request_key',
    311:    'keyctl',
    312:    'semtimedop',
    313:    'vserver',
    314:    'ioprio_set',
    315:    'ioprio_get',
    316:    'inotify_init',
    317:    'inotify_add_watch',
    318:    'inotify_rm_watch',
    319:    'mbind',
    320:    'get_mempolicy',
    321:    'set_mempolicy',
    322:    'openat',
    323:    'mkdirat',
    324:    'mknodat',
    325:    'fchownat',
    326:    'futimesat',
    327:    'fstatat64',
    328:    'unlinkat',
    329:    'renameat',
    330:    'linkat',
    331:    'symlinkat',
    332:    'readlinkat',
    333:    'fchmodat',
    334:    'faccessat',
    335:    'pselect6',
    336:    'ppoll',
    337:    'unshare',
    338:    'set_robust_list',
    339:    'get_robust_list',
    340:    'splice',
    341:    'arm_sync_file_range', # same as sync_file_range2 in linux kernel
    342:    'tee',
    343:    'vmsplice',
    344:    'move_pages',
    345:    'getcpu',
    346:    'epoll_pwait',
    347:    'kexec_load',
    348:    'utimensat',
    349:    'signalfd',
    350:    'timerfd_create',
    351:    'eventfd',
    352:    'fallocate',
    353:    'timerfd_settime',
    354:    'timerfd_gettime',
    355:    'signalfd4',
    356:    'eventfd2',
    357:    'epoll_create1',
    358:    'dup3',
    359:    'pipe2',
    360:    'inotify_init1',
    361:    'preadv',
    362:    'pwritev',
    363:    'rt_tgsigqueueinfo',
    364:    'perf_event_open',
    365:    'recvmmsg',
    366:    'accept4',
    367:    'fanotify_init',
    368:    'fanotify_mark',
    369:    'prlimit64',
    370:    'name_to_handle_at',
    371:    'open_by_handle_at',
    372:    'clock_adjtime',
    373:    'syncfs',
    374:    'sendmmsg',
    375:    'setns',
    376:    'process_vm_readv',
    377:    'process_vm_writev',
    378:    'kcmp',
    379:    'finit_module',
    380:    'sched_setattr',
    381:    'sched_getattr',
    382:    'renameat2',
    383:    'seccomp',
    384:    'getrandom',
    385:    'memfd_create',
    386:    'bpf',
    387:    'execveat',
    388:    'userfaultfd',
    389:    'membarrier',
    390:    'mlock2',
    391:    'copy_file_range',
    392:    'preadv2',
    393:    'pwritev2',
    394:    'pkey_mprotect',
    395:    'pkey_alloc',
    396:    'pkey_free',
})

# Ref: https://github.com/gumstix/linux/blob/yocto-v3.18.y/arch/arm/include/uapi/asm/unistd.h
# Generated from ARMEL[k+0x900000] = v
lib.add_number_mapping_from_dict('ARMHF', {
    9437184: 'restart_syscall',
    9437185: 'exit',
    9437186: 'fork',
    9437187: 'read',
    9437188: 'write',
    9437189: 'open',
    9437190: 'close',
    9437192: 'creat',
    9437193: 'link',
    9437194: 'unlink',
    9437195: 'execve',
    9437196: 'chdir',
    9437197: 'time',
    9437198: 'mknod',
    9437199: 'chmod',
    9437200: 'lchown',
    9437203: 'lseek',
    9437204: 'getpid',
    9437205: 'mount',
    9437206: 'umount',
    9437207: 'setuid',
    9437208: 'getuid',
    9437209: 'stime',
    9437210: 'ptrace',
    9437211: 'alarm',
    9437213: 'pause',
    9437214: 'utime',
    9437217: 'access',
    9437218: 'nice',
    9437220: 'sync',
    9437221: 'kill',
    9437222: 'rename',
    9437223: 'mkdir',
    9437224: 'rmdir',
    9437225: 'dup',
    9437226: 'pipe',
    9437227: 'times',
    9437229: 'brk',
    9437230: 'setgid',
    9437231: 'getgid',
    9437233: 'geteuid',
    9437234: 'getegid',
    9437235: 'acct',
    9437236: 'umount2',
    9437238: 'ioctl',
    9437239: 'fcntl',
    9437241: 'setpgid',
    9437244: 'umask',
    9437245: 'chroot',
    9437246: 'ustat',
    9437247: 'dup2',
    9437248: 'getppid',
    9437249: 'getpgrp',
    9437250: 'setsid',
    9437251: 'sigaction',
    9437254: 'setreuid',
    9437255: 'setregid',
    9437256: 'sigsuspend',
    9437257: 'sigpending',
    9437258: 'sethostname',
    9437259: 'setrlimit',
    9437260: 'getrlimit',
    9437261: 'getrusage',
    9437262: 'gettimeofday',
    9437263: 'settimeofday',
    9437264: 'getgroups',
    9437265: 'setgroups',
    9437266: 'select',
    9437267: 'symlink',
    9437269: 'readlink',
    9437270: 'uselib',
    9437271: 'swapon',
    9437272: 'reboot',
    9437273: 'readdir',
    9437274: 'mmap',
    9437275: 'munmap',
    9437276: 'truncate',
    9437277: 'ftruncate',
    9437278: 'fchmod',
    9437279: 'fchown',
    9437280: 'getpriority',
    9437281: 'setpriority',
    9437283: 'statfs',
    9437284: 'fstatfs',
    9437286: 'socketcall',
    9437287: 'syslog',
    9437288: 'setitimer',
    9437289: 'getitimer',
    9437290: 'stat',
    9437291: 'lstat',
    9437292: 'fstat',
    9437295: 'vhangup',
    9437297: 'syscall',
    9437298: 'wait4',
    9437299: 'swapoff',
    9437300: 'sysinfo',
    9437301: 'ipc',
    9437302: 'fsync',
    9437303: 'sigreturn',
    9437304: 'clone',
    9437305: 'setdomainname',
    9437306: 'uname',
    9437308: 'adjtimex',
    9437309: 'mprotect',
    9437310: 'sigprocmask',
    9437312: 'init_module',
    9437313: 'delete_module',
    9437315: 'quotactl',
    9437316: 'getpgid',
    9437317: 'fchdir',
    9437318: 'bdflush',
    9437319: 'sysfs',
    9437320: 'personality',
    9437322: 'setfsuid',
    9437323: 'setfsgid',
    9437324: '_llseek',
    9437325: 'getdents',
    9437326: '_newselect',
    9437327: 'flock',
    9437328: 'msync',
    9437329: 'readv',
    9437330: 'writev',
    9437331: 'getsid',
    9437332: 'fdatasync',
    9437333: '_sysctl',
    9437334: 'mlock',
    9437335: 'munlock',
    9437336: 'mlockall',
    9437337: 'munlockall',
    9437338: 'sched_setparam',
    9437339: 'sched_getparam',
    9437340: 'sched_setscheduler',
    9437341: 'sched_getscheduler',
    9437342: 'sched_yield',
    9437343: 'sched_get_priority_max',
    9437344: 'sched_get_priority_min',
    9437345: 'sched_rr_get_interval',
    9437346: 'nanosleep',
    9437347: 'mremap',
    9437348: 'setresuid',
    9437349: 'getresuid',
    9437352: 'poll',
    9437353: 'nfsservctl',
    9437354: 'setresgid',
    9437355: 'getresgid',
    9437356: 'prctl',
    9437357: 'rt_sigreturn',
    9437358: 'rt_sigaction',
    9437359: 'rt_sigprocmask',
    9437360: 'rt_sigpending',
    9437361: 'rt_sigtimedwait',
    9437362: 'rt_sigqueueinfo',
    9437363: 'rt_sigsuspend',
    9437364: 'pread64',
    9437365: 'pwrite64',
    9437366: 'chown',
    9437367: 'getcwd',
    9437368: 'capget',
    9437369: 'capset',
    9437370: 'sigaltstack',
    9437371: 'sendfile',
    9437374: 'vfork',
    9437375: 'ugetrlimit',
    9437376: 'mmap2',
    9437377: 'truncate64',
    9437378: 'ftruncate64',
    9437379: 'stat64',
    9437380: 'lstat64',
    9437381: 'fstat64',
    9437382: 'lchown32',
    9437383: 'getuid32',
    9437384: 'getgid32',
    9437385: 'geteuid32',
    9437386: 'getegid32',
    9437387: 'setreuid32',
    9437388: 'setregid32',
    9437389: 'getgroups32',
    9437390: 'setgroups32',
    9437391: 'fchown32',
    9437392: 'setresuid32',
    9437393: 'getresuid32',
    9437394: 'setresgid32',
    9437395: 'getresgid32',
    9437396: 'chown32',
    9437397: 'setuid32',
    9437398: 'setgid32',
    9437399: 'setfsuid32',
    9437400: 'setfsgid32',
    9437401: 'getdents64',
    9437402: 'pivot_root',
    9437403: 'mincore',
    9437404: 'madvise',
    9437405: 'fcntl64',
    9437408: 'gettid',
    9437409: 'readahead',
    9437410: 'setxattr',
    9437411: 'lsetxattr',
    9437412: 'fsetxattr',
    9437413: 'getxattr',
    9437414: 'lgetxattr',
    9437415: 'fgetxattr',
    9437416: 'listxattr',
    9437417: 'llistxattr',
    9437418: 'flistxattr',
    9437419: 'removexattr',
    9437420: 'lremovexattr',
    9437421: 'fremovexattr',
    9437422: 'tkill',
    9437423: 'sendfile64',
    9437424: 'futex',
    9437425: 'sched_setaffinity',
    9437426: 'sched_getaffinity',
    9437427: 'io_setup',
    9437428: 'io_destroy',
    9437429: 'io_getevents',
    9437430: 'io_submit',
    9437431: 'io_cancel',
    9437432: 'exit_group',
    9437433: 'lookup_dcookie',
    9437434: 'epoll_create',
    9437435: 'epoll_ctl',
    9437436: 'epoll_wait',
    9437437: 'remap_file_pages',
    9437440: 'set_tid_address',
    9437441: 'timer_create',
    9437442: 'timer_settime',
    9437443: 'timer_gettime',
    9437444: 'timer_getoverrun',
    9437445: 'timer_delete',
    9437446: 'clock_settime',
    9437447: 'clock_gettime',
    9437448: 'clock_getres',
    9437449: 'clock_nanosleep',
    9437450: 'statfs64',
    9437451: 'fstatfs64',
    9437452: 'tgkill',
    9437453: 'utimes',
    9437454: 'arm_fadvise64_64',
    9437455: 'pciconfig_iobase',
    9437456: 'pciconfig_read',
    9437457: 'pciconfig_write',
    9437458: 'mq_open',
    9437459: 'mq_unlink',
    9437460: 'mq_timedsend',
    9437461: 'mq_timedreceive',
    9437462: 'mq_notify',
    9437463: 'mq_getsetattr',
    9437464: 'waitid',
    9437465: 'socket',
    9437466: 'bind',
    9437467: 'connect',
    9437468: 'listen',
    9437469: 'accept',
    9437470: 'getsockname',
    9437471: 'getpeername',
    9437472: 'socketpair',
    9437473: 'send',
    9437474: 'sendto',
    9437475: 'recv',
    9437476: 'recvfrom',
    9437477: 'shutdown',
    9437478: 'setsockopt',
    9437479: 'getsockopt',
    9437480: 'sendmsg',
    9437481: 'recvmsg',
    9437482: 'semop',
    9437483: 'semget',
    9437484: 'semctl',
    9437485: 'msgsnd',
    9437486: 'msgrcv',
    9437487: 'msgget',
    9437488: 'msgctl',
    9437489: 'shmat',
    9437490: 'shmdt',
    9437491: 'shmget',
    9437492: 'shmctl',
    9437493: 'add_key',
    9437494: 'request_key',
    9437495: 'keyctl',
    9437496: 'semtimedop',
    9437497: 'vserver',
    9437498: 'ioprio_set',
    9437499: 'ioprio_get',
    9437500: 'inotify_init',
    9437501: 'inotify_add_watch',
    9437502: 'inotify_rm_watch',
    9437503: 'mbind',
    9437504: 'get_mempolicy',
    9437505: 'set_mempolicy',
    9437506: 'openat',
    9437507: 'mkdirat',
    9437508: 'mknodat',
    9437509: 'fchownat',
    9437510: 'futimesat',
    9437511: 'fstatat64',
    9437512: 'unlinkat',
    9437513: 'renameat',
    9437514: 'linkat',
    9437515: 'symlinkat',
    9437516: 'readlinkat',
    9437517: 'fchmodat',
    9437518: 'faccessat',
    9437519: 'pselect6',
    9437520: 'ppoll',
    9437521: 'unshare',
    9437522: 'set_robust_list',
    9437523: 'get_robust_list',
    9437524: 'splice',
    9437525: 'arm_sync_file_range',
    9437526: 'tee',
    9437527: 'vmsplice',
    9437528: 'move_pages',
    9437529: 'getcpu',
    9437530: 'epoll_pwait',
    9437531: 'kexec_load',
    9437532: 'utimensat',
    9437533: 'signalfd',
    9437534: 'timerfd_create',
    9437535: 'eventfd',
    9437536: 'fallocate',
    9437537: 'timerfd_settime',
    9437538: 'timerfd_gettime',
    9437539: 'signalfd4',
    9437540: 'eventfd2',
    9437541: 'epoll_create1',
    9437542: 'dup3',
    9437543: 'pipe2',
    9437544: 'inotify_init1',
    9437545: 'preadv',
    9437546: 'pwritev',
    9437547: 'rt_tgsigqueueinfo',
    9437548: 'perf_event_open',
    9437549: 'recvmmsg',
    9437550: 'accept4',
    9437551: 'fanotify_init',
    9437552: 'fanotify_mark',
    9437553: 'prlimit64',
    9437554: 'name_to_handle_at',
    9437555: 'open_by_handle_at',
    9437556: 'clock_adjtime',
    9437557: 'syncfs',
    9437558: 'sendmmsg',
    9437559: 'setns',
    9437560: 'process_vm_readv',
    9437561: 'process_vm_writev',
    9437562: 'kcmp',
    9437563: 'finit_module',
    9437564: 'sched_setattr',
    9437565: 'sched_getattr',
    9437566: 'renameat2',
    9437567: 'seccomp',
    9437568: 'getrandom',
    9437569: 'memfd_create',
    9437570: 'bpf',
    9437571: 'execveat',
    9437572: 'userfaultfd',
    9437573: 'membarrier',
    9437574: 'mlock2',
    9437575: 'copy_file_range',
    9437576: 'preadv2',
    9437577: 'pwritev2',
    9437578: 'pkey_mprotect',
    9437579: 'pkey_alloc',
    9437580: 'pkey_free'
})

